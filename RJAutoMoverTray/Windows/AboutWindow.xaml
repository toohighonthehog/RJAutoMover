<Window x:Class="RJAutoMoverTray.Windows.AboutWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:RJAutoMoverTray.Windows"
        Title="About RJAutoMover"
        Height="600" Width="700"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterScreen"
        ShowInTaskbar="False"
        WindowStyle="ToolWindow"
        Background="#F5F5F5"
        TextOptions.TextFormattingMode="Display">

    <Window.Resources>
        <!-- Converter for showing/hiding date criteria fields -->
        <local:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>
        <!-- Gradient background for header -->
        <LinearGradientBrush x:Key="HeaderGradient" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#4A90E2" Offset="0"/>
            <GradientStop Color="#357ABD" Offset="1"/>
        </LinearGradientBrush>

        <!-- Style for info labels -->
        <Style x:Key="InfoLabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#666666"/>
            <Setter Property="Margin" Value="0,0,10,0"/>
        </Style>

        <!-- Style for info values -->
        <Style x:Key="InfoValueStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
        </Style>

        <!-- Style for section headers -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#357ABD"/>
            <Setter Property="Margin" Value="0,15,0,10"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header with Icon and App Name -->
        <Border x:Name="HeaderBorder" Grid.Row="0" Background="{StaticResource HeaderGradient}" Padding="20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Large Icon -->
                <Image x:Name="AppIcon" Grid.Column="0" Width="64" Height="64"
                       Margin="0,0,20,0" VerticalAlignment="Center"/>

                <!-- App Name and Tagline -->
                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                    <TextBlock Text="RJAutoMover" FontSize="24" FontWeight="Bold"
                               Foreground="White" Margin="0,0,0,5"/>
                    <TextBlock Text="Automated File Management Service" FontSize="12"
                               Foreground="#E0E0E0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Content Area with Tabs -->
        <TabControl x:Name="TabControl" Grid.Row="1" Margin="15,10,15,10" Background="Transparent" BorderThickness="0">
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TabItem">
                                <Border Name="Border" BorderThickness="1,1,1,0" BorderBrush="#DDDDDD"
                                        CornerRadius="4,4,0,0" Margin="2,0" Padding="15,8">
                                    <ContentPresenter x:Name="ContentSite" ContentSource="Header"
                                                    HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="Border" Property="Background" Value="White"/>
                                        <Setter Property="Foreground" Value="#357ABD"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </Trigger>
                                    <Trigger Property="IsSelected" Value="False">
                                        <Setter TargetName="Border" Property="Background" Value="#E8E8E8"/>
                                        <Setter Property="Foreground" Value="#666666"/>
                                    </Trigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Border" Property="Background" Value="#F0F0F0"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </TabControl.Resources>


            <!-- Transfers Tab -->
            <TabItem Header="Transfers">
                <Border Background="White" BorderBrush="#DDDDDD" BorderThickness="1,0,1,1" Padding="15">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Controls Row -->
                        <Grid Grid.Row="0" Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="Recent Transfers" FontSize="14" FontWeight="Bold" Foreground="#357ABD" VerticalAlignment="Center"/>

                            <!-- Session Filter -->
                            <ComboBox x:Name="SessionFilterComboBox" Grid.Column="2" Width="130" SelectionChanged="SessionFilter_Changed">
                                <ComboBoxItem Content="All Sessions" IsSelected="True" Tag="All"/>
                                <ComboBoxItem Content="Current Session" Tag="Current"/>
                                <ComboBoxItem Content="Previous Sessions" Tag="Previous"/>
                            </ComboBox>

                            <!-- Search Box -->
                            <TextBox x:Name="TransfersSearchTextBox" Grid.Column="4" Width="200"
                                     Padding="5" TextChanged="TransfersSearch_TextChanged"
                                     Text="Search transfers..."
                                     Foreground="#999999"
                                     GotFocus="TransfersSearchTextBox_GotFocus"
                                     LostFocus="TransfersSearchTextBox_LostFocus"/>

                            <Button x:Name="TransfersToggleButton" Grid.Column="6" Content="Pause Processing" Padding="15,6" MinWidth="120" Click="TransfersToggleButton_Click">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Background" Value="#EEEEEE"/>
                                        <Setter Property="Foreground" Value="#333333"/>
                                        <Setter Property="BorderThickness" Value="0"/>
                                        <Setter Property="FontWeight" Value="Normal"/>
                                        <Setter Property="Cursor" Value="Hand"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}" CornerRadius="3" Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#DDDDDD"/>
                                            </Trigger>
                                            <Trigger Property="IsEnabled" Value="False">
                                                <Setter Property="Background" Value="#F5F5F5"/>
                                                <Setter Property="Foreground" Value="#AAAAAA"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </Grid>

                        <!-- Transfer Items Container -->
                        <Border Grid.Row="1" Background="#F8F8F8" BorderBrush="#DDDDDD" BorderThickness="1" CornerRadius="5">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Column Headers -->
                                <Border Grid.Row="0" Background="#357ABD" Padding="10,4" CornerRadius="3,3,0,0">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="125"/>
                                            <ColumnDefinition Width="70"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="135"/>
                                            <ColumnDefinition Width="30"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock x:Name="TimeColumnHeader" Grid.Column="0" Text="Time ▼" FontSize="11" FontWeight="Bold" Foreground="White" VerticalAlignment="Center" Cursor="Hand" MouseLeftButtonDown="SortColumn_Click" Tag="Time"/>
                                        <TextBlock x:Name="SizeColumnHeader" Grid.Column="1" Text="Size" FontSize="11" FontWeight="Bold" Foreground="White" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0,0,10,0" Cursor="Hand" MouseLeftButtonDown="SortColumn_Click" Tag="Size"/>
                                        <TextBlock x:Name="FilenameColumnHeader" Grid.Column="2" Text="Filename" FontSize="11" FontWeight="Bold" Foreground="White" VerticalAlignment="Center" Margin="10,0" Cursor="Hand" MouseLeftButtonDown="SortColumn_Click" Tag="Filename"/>
                                        <TextBlock x:Name="RuleColumnHeader" Grid.Column="3" Text="Rule" FontSize="11" FontWeight="Bold" Foreground="White" VerticalAlignment="Center" Cursor="Hand" MouseLeftButtonDown="SortColumn_Click" Tag="Rule"/>
                                        <TextBlock Grid.Column="4" Text="" FontSize="11" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                </Border>

                                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Background="White">
                                <ItemsControl x:Name="TransfersItemsControl" Margin="0">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Padding="10,0" BorderThickness="0" ToolTip="{Binding RuleTooltip}">
                                                <Border.Style>
                                                    <Style TargetType="Border">
                                                        <Setter Property="Background" Value="White"/>
                                                        <Style.Triggers>
                                                            <!-- Color coding based on status -->
                                                            <DataTrigger Binding="{Binding StatusIcon}" Value="✓">
                                                                <Setter Property="Background" Value="#F0FFF0"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding StatusIcon}" Value="✗">
                                                                <Setter Property="Background" Value="#FFF0F0"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding StatusIcon}" Value="⚠">
                                                                <Setter Property="Background" Value="#FFF8DC"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding IsInProgress}" Value="True">
                                                                <Setter Property="Background" Value="#E8F4F8"/>
                                                            </DataTrigger>
                                                            <!-- Mouse over effect -->
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="#E0E0E0"/>
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="125"/>
                                                        <ColumnDefinition Width="70"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="135"/>
                                                        <ColumnDefinition Width="30"/>
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock Grid.Column="0" Text="{Binding Timestamp}" FontSize="11" FontWeight="Normal" Foreground="#666666" VerticalAlignment="Center" ToolTip="{Binding TimestampTooltip}"/>
                                                    <TextBlock Grid.Column="1" Text="{Binding FileSize}" FontSize="11" FontWeight="Normal" Foreground="#666666" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0,0,10,0" ToolTip="{Binding FileSizeTooltip}"/>
                                                    <TextBlock Grid.Column="2" Text="{Binding FileName}" FontSize="11" FontWeight="Normal" Foreground="#333333" TextTrimming="CharacterEllipsis" VerticalAlignment="Center" Margin="10,0" ToolTip="{Binding FullPathTooltip}"/>
                                                    <TextBlock Grid.Column="3" Text="{Binding RuleName}" FontSize="11" FontWeight="Normal" Foreground="#666666" VerticalAlignment="Center"/>
                                                    <TextBlock Grid.Column="4" Text="{Binding StatusIcon}" FontSize="13" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                                </ScrollViewer>

                                <!-- Database Path Display -->
                                <TextBlock Grid.Row="2" x:Name="DatabasePathText"
                                           Padding="10,5" FontSize="9" FontStyle="Italic"
                                           Foreground="#999999" TextWrapping="NoWrap"
                                           Text="Activity history database: "/>
                            </Grid>
                        </Border>
                    </Grid>
                </Border>
            </TabItem>

            <!-- Configuration Tab (config.yaml) -->
            <TabItem Header="Configuration">
                <Border Background="White" BorderBrush="#DDDDDD" BorderThickness="1,0,1,1" Padding="15">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Toggle between parsed and raw view -->
                                <StackPanel Grid.Row="0" Margin="0,0,0,10">
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Button x:Name="ShowParsedConfigButton" Content="Parsed View"
                                                Padding="10,5" Margin="0,0,5,0" Click="ShowParsedConfig_Click"
                                                Background="#4A90E2" Foreground="White" BorderThickness="0" FontWeight="Bold">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border Background="{TemplateBinding Background}" CornerRadius="3" Padding="{TemplateBinding Padding}">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#357ABD"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <Button x:Name="ShowRawConfigButton" Content="Raw YAML"
                                        Padding="10,5" Click="ShowRawConfig_Click"
                                        Background="#DDDDDD" Foreground="#333333" BorderThickness="0" FontWeight="Normal">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border Background="{TemplateBinding Background}" CornerRadius="3" Padding="{TemplateBinding Padding}">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#CCCCCC"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <!-- Config Editor Button will be added programmatically -->
                            </StackPanel>
                        </StackPanel>

                        <!-- Config Content Container -->
                        <Border Grid.Row="1" Background="#F8F8F8" BorderBrush="#DDDDDD" BorderThickness="1" CornerRadius="5">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Parsed Config View -->
                                <ScrollViewer x:Name="ParsedConfigView" Grid.Row="0" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Visibility="Visible" Background="White">
                            <StackPanel>
                            <!-- File Rules Section -->
                            <TextBlock Text="File Rules" FontSize="14" FontWeight="Bold"
                                       Foreground="#357ABD" Margin="0,5,0,10"/>
                            <ItemsControl x:Name="FileRulesItemsControl">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="#F8F8F8" BorderBrush="#DDDDDD"
                                                BorderThickness="1" Padding="12" CornerRadius="5"
                                                Margin="0,0,0,8">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="8"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="140"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <!-- Rule Name with Status Badge -->
                                                <StackPanel Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
                                                           Orientation="Horizontal">
                                                    <TextBlock Text="{Binding Name}" FontSize="13"
                                                              FontWeight="Bold" Foreground="#357ABD"/>
                                                    <Border Background="{Binding StatusColor}" CornerRadius="3"
                                                           Padding="6,2" Margin="10,0,0,0">
                                                        <TextBlock Text="{Binding StatusText}" FontSize="10"
                                                                  Foreground="White" FontWeight="Bold"/>
                                                    </Border>
                                                </StackPanel>

                                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Source:"
                                                          FontSize="11" Foreground="#666666" FontWeight="Bold" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                                <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding SourceFolder}"
                                                          FontSize="11" Foreground="#333333" FontWeight="Normal"
                                                          TextWrapping="Wrap" Margin="0,0,0,0" VerticalAlignment="Center"
                                                          ToolTip="{Binding SourceFolder}"/>

                                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Destination:"
                                                          FontSize="11" Foreground="#666666" FontWeight="Bold" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                                <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding DestinationFolder}"
                                                          FontSize="11" Foreground="#333333" FontWeight="Normal"
                                                          TextWrapping="Wrap" Margin="0,0,0,0" VerticalAlignment="Center"
                                                          ToolTip="{Binding DestinationFolder}"/>

                                                <TextBlock Grid.Row="4" Grid.Column="0" Text="Extensions:"
                                                          FontSize="11" Foreground="#666666" FontWeight="Bold" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                                <ItemsControl Grid.Row="4" Grid.Column="1" ItemsSource="{Binding Extensions}" Margin="0,0,0,0" VerticalAlignment="Center">
                                                    <ItemsControl.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <WrapPanel Orientation="Horizontal"/>
                                                        </ItemsPanelTemplate>
                                                    </ItemsControl.ItemsPanel>
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Border Background="{Binding Color}" CornerRadius="2"
                                                                    Padding="4,1" Margin="0,0,3,0" Height="16" VerticalAlignment="Center">
                                                                <TextBlock Text="{Binding Extension}" FontSize="10"
                                                                          FontWeight="SemiBold" Foreground="White" VerticalAlignment="Center"/>
                                                            </Border>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>

                                                <TextBlock Grid.Row="5" Grid.Column="0" Text="Scan Interval:"
                                                          FontSize="11" Foreground="#666666" FontWeight="Bold" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                                <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding ScanIntervalDisplay}"
                                                          FontSize="11" Foreground="#333333" FontWeight="Normal" Margin="0,0,0,0" VerticalAlignment="Center"/>

                                                <TextBlock Grid.Row="6" Grid.Column="0" Text="File Exists:"
                                                          FontSize="11" Foreground="#666666" FontWeight="Bold" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                                <TextBlock Grid.Row="6" Grid.Column="1" Text="{Binding FileExists}"
                                                          FontSize="11" Foreground="#333333" FontWeight="Normal" Margin="0,0,0,0" VerticalAlignment="Center"/>

                                                <!-- Date Criteria (only shown if specified) -->
                                                <TextBlock Grid.Row="7" Grid.Column="0" Text="Date Filter:"
                                                          FontSize="11" Foreground="#666666" FontWeight="Bold" Margin="0,0,10,0" VerticalAlignment="Center"
                                                          Visibility="{Binding DateCriteria, Converter={StaticResource NullToVisibilityConverter}}"/>
                                                <TextBlock Grid.Row="7" Grid.Column="1" Text="{Binding DateCriteria}"
                                                          FontSize="11" Foreground="#8B4513" FontWeight="SemiBold" Margin="0,0,0,0" VerticalAlignment="Center"
                                                          Visibility="{Binding DateCriteria, Converter={StaticResource NullToVisibilityConverter}}"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>

                            <!-- Application Settings Section -->
                            <TextBlock Text="Application Settings" FontSize="14" FontWeight="Bold"
                                       Foreground="#357ABD" Margin="0,15,0,10"/>
                            <Border Background="#F8F8F8" BorderBrush="#DDDDDD"
                                    BorderThickness="1" Padding="12" CornerRadius="5">
                                <ItemsControl x:Name="AppSettingsItemsControl">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Grid Margin="0,0,0,8">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="220"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <!-- Label with YAML field name -->
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="{Binding DisplayName}" FontSize="11"
                                                              Foreground="#666666" FontWeight="Bold"/>
                                                    <TextBlock Text="{Binding YamlFieldName}" FontSize="9"
                                                              Foreground="#999999" FontStyle="Italic" FontWeight="Normal" Margin="0,1,0,0"/>
                                                </StackPanel>

                                                <!-- Value with [default] indicator -->
                                                <TextBlock Grid.Column="1" FontSize="11" Foreground="#333333"
                                                          FontWeight="Normal" VerticalAlignment="Center" TextWrapping="NoWrap">
                                                    <Run Text="{Binding Value}" FontWeight="Normal"/>
                                                    <Run Text="{Binding DefaultIndicator}" Foreground="#888888" FontStyle="Italic" FontWeight="Normal"/>
                                                </TextBlock>
                                            </Grid>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </Border>
                        </StackPanel>
                                </ScrollViewer>

                                <!-- Raw Config View -->
                                <ScrollViewer x:Name="RawConfigView" Grid.Row="0" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" Visibility="Collapsed" Background="White">
                                    <TextBox x:Name="RawConfigTextBox"
                                             FontFamily="Consolas, Courier New" FontSize="11"
                                             Foreground="#333333" Background="Transparent"
                                             IsReadOnly="True" BorderThickness="0"
                                             TextWrapping="NoWrap" Padding="15"
                                             VerticalScrollBarVisibility="Disabled"
                                             HorizontalScrollBarVisibility="Disabled"/>
                                </ScrollViewer>

                                        <!-- Config File Path Display -->
                                        <TextBlock Grid.Row="1" x:Name="ConfigFilePathTextBlock"
                                                   Padding="10,5" FontSize="9" FontStyle="Italic"
                                                   Foreground="#999999" TextWrapping="NoWrap"
                                                   Text=""/>
                                    </Grid>
                                </Border>
                            </Grid>
                </Border>
            </TabItem>

            <!-- Logs Tab -->
            <TabItem Header="Logs">
                <Border Background="White" BorderBrush="#DDDDDD" BorderThickness="1,0,1,1" Padding="15">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Log Controls -->
                        <Grid Grid.Row="0" Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Log Source Selection -->
                            <ComboBox x:Name="LogSourceComboBox" Grid.Column="0" Width="150"
                                      SelectionChanged="LogSourceComboBox_SelectionChanged">
                                <ComboBoxItem Content="Service Logs" IsSelected="True" Tag="Service"/>
                                <ComboBoxItem Content="Tray Logs" Tag="Tray"/>
                            </ComboBox>

                            <!-- Log Level Filter -->
                            <ComboBox x:Name="LogLevelFilterComboBox" Grid.Column="2" Width="120"
                                      SelectionChanged="LogLevelFilter_Changed">
                                <ComboBoxItem Content="All Levels" IsSelected="True" Tag="ALL"/>
                                <ComboBoxItem Content="ERROR" Tag="ERROR"/>
                                <ComboBoxItem Content="WARN" Tag="WARN"/>
                                <ComboBoxItem Content="INFO" Tag="INFO"/>
                                <ComboBoxItem Content="DEBUG" Tag="DEBUG"/>
                                <ComboBoxItem Content="gRPC" Tag="GRPC"/>
                            </ComboBox>

                            <!-- Search Box -->
                            <TextBox x:Name="LogSearchTextBox" Grid.Column="4" Width="200"
                                     Padding="5" TextChanged="LogSearch_TextChanged"
                                     Text="Search logs..."
                                     Foreground="#999999"
                                     GotFocus="LogSearchTextBox_GotFocus"
                                     LostFocus="LogSearchTextBox_LostFocus"/>
                        </Grid>

                        <!-- Log Viewer -->
                        <Border Grid.Row="1" Background="#F8F8F8" BorderBrush="#DDDDDD"
                                BorderThickness="1" CornerRadius="5">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <ScrollViewer Grid.Row="0" x:Name="LogScrollViewer" VerticalScrollBarVisibility="Auto"
                                              HorizontalScrollBarVisibility="Auto">
                                    <TextBox x:Name="LogTextBox"
                                             FontFamily="Consolas, Courier New" FontSize="10"
                                             Foreground="#333333" Background="Transparent"
                                             IsReadOnly="True" BorderThickness="0"
                                             TextWrapping="NoWrap" Padding="10"
                                             VerticalScrollBarVisibility="Disabled"
                                             HorizontalScrollBarVisibility="Disabled"
                                             Text="Loading logs..."/>
                                </ScrollViewer>

                                <!-- Log Folder Path Display -->
                                <TextBlock Grid.Row="1" x:Name="LogFolderPathText"
                                           Padding="10,5" FontSize="9" FontStyle="Italic"
                                           Foreground="#999999" TextWrapping="NoWrap"
                                           Text="Log folder: "/>
                            </Grid>
                        </Border>
                    </Grid>
                </Border>
            </TabItem>

            <!-- Status Information Tab -->
            <TabItem Header="Status">
                <Border Background="White" BorderBrush="#DDDDDD" BorderThickness="1,0,1,1" Padding="15">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="6"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="6"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- System Info Section -->
                        <Border Grid.Row="0" Background="#F8F8F8" BorderBrush="#DDDDDD"
                                BorderThickness="1" Padding="10" CornerRadius="5">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="5"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Install Location:"
                                           Style="{StaticResource InfoLabelStyle}"/>
                                <TextBlock x:Name="InstallPathText" Grid.Row="0" Grid.Column="1"
                                           Style="{StaticResource InfoValueStyle}"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Operating System:"
                                           Style="{StaticResource InfoLabelStyle}"/>
                                <TextBlock x:Name="OSVersionText" Grid.Row="2" Grid.Column="1"
                                           Style="{StaticResource InfoValueStyle}"/>
                            </Grid>
                        </Border>

                        <!-- Memory & Uptime Section (Clickable to refresh) -->
                        <Button Grid.Row="2" Background="#F8F8F8" BorderBrush="#DDDDDD"
                                BorderThickness="1" Padding="10" HorizontalContentAlignment="Stretch"
                                Cursor="Hand" Click="RefreshSystemInfo_Click"
                                ToolTip="Click to refresh system information">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        CornerRadius="5"
                                                        Padding="{TemplateBinding Padding}">
                                                    <ContentPresenter/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#E8F4F8"/>
                                            <Setter Property="BorderBrush" Value="#4A90E2"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="5"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="5"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="5"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Tray Memory:"
                                           Style="{StaticResource InfoLabelStyle}"/>
                                <TextBlock x:Name="TrayMemoryText" Grid.Row="0" Grid.Column="1"
                                           Style="{StaticResource InfoValueStyle}"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Tray Uptime:"
                                           Style="{StaticResource InfoLabelStyle}"/>
                                <TextBlock x:Name="TrayUptimeText" Grid.Row="2" Grid.Column="1"
                                           Style="{StaticResource InfoValueStyle}"/>

                                <TextBlock Grid.Row="4" Grid.Column="0" Text="Service Memory:"
                                           Style="{StaticResource InfoLabelStyle}"/>
                                <TextBlock x:Name="ServiceMemoryText" Grid.Row="4" Grid.Column="1"
                                           Style="{StaticResource InfoValueStyle}"/>

                                <TextBlock Grid.Row="6" Grid.Column="0" Text="Service Uptime:"
                                           Style="{StaticResource InfoLabelStyle}"/>
                                <TextBlock x:Name="ServiceUptimeText" Grid.Row="6" Grid.Column="1"
                                           Style="{StaticResource InfoValueStyle}"/>
                            </Grid>
                        </Button>

                        <!-- Database Statistics Section (Clickable to refresh) -->
                        <Button Grid.Row="4" Background="#F8F8F8" BorderBrush="#DDDDDD"
                                BorderThickness="1" Padding="10" HorizontalContentAlignment="Stretch"
                                Cursor="Hand" Click="RefreshDatabaseStats_Click"
                                ToolTip="Click to refresh database statistics">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        CornerRadius="5"
                                                        Padding="{TemplateBinding Padding}">
                                                    <ContentPresenter/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#E8F4F8"/>
                                            <Setter Property="BorderBrush" Value="#4A90E2"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="5"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="5"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="5"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Database Path:"
                                           Style="{StaticResource InfoLabelStyle}"/>
                                <TextBlock x:Name="SystemDatabasePathText" Grid.Row="0" Grid.Column="1"
                                           Style="{StaticResource InfoValueStyle}"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Database Status:"
                                           Style="{StaticResource InfoLabelStyle}"/>
                                <TextBlock x:Name="SystemDatabaseStatusText" Grid.Row="2" Grid.Column="1"
                                           Style="{StaticResource InfoValueStyle}"/>

                                <TextBlock Grid.Row="4" Grid.Column="0" Text="Total Records:"
                                           Style="{StaticResource InfoLabelStyle}"/>
                                <TextBlock x:Name="SystemDatabaseRecordCountText" Grid.Row="4" Grid.Column="1"
                                           Style="{StaticResource InfoValueStyle}"/>

                                <TextBlock Grid.Row="6" Grid.Column="0" Text="Last Transfer:"
                                           Style="{StaticResource InfoLabelStyle}"/>
                                <TextBlock x:Name="SystemDatabaseLastTransferText" Grid.Row="6" Grid.Column="1"
                                           Style="{StaticResource InfoValueStyle}"/>
                            </Grid>
                        </Button>
                    </Grid>
                </Border>
            </TabItem>

            <!-- Version Information Tab -->
            <TabItem Header="Version">
                <Border Background="White" BorderBrush="#DDDDDD" BorderThickness="1,0,1,1" Padding="15">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Toggle between Version Info and .NET Build Info -->
                        <StackPanel Grid.Row="0" Margin="0,0,0,10">
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                <Button x:Name="ShowVersionInfoButton" Content="Version Info"
                                        Padding="10,5" Margin="0,0,5,0" Click="ShowVersionInfo_Click"
                                        Background="#4A90E2" Foreground="White" BorderThickness="0" FontWeight="Bold">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border Background="{TemplateBinding Background}" CornerRadius="3" Padding="{TemplateBinding Padding}">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#357ABD"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <Button x:Name="ShowDotNetInfoButton" Content=".NET Build Info"
                                        Padding="10,5" Click="ShowDotNetInfo_Click"
                                        Background="#DDDDDD" Foreground="#333333" BorderThickness="0" FontWeight="Normal">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border Background="{TemplateBinding Background}" CornerRadius="3" Padding="{TemplateBinding Padding}">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#CCCCCC"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </StackPanel>
                        </StackPanel>

                        <!-- Version Info View -->
                        <Grid x:Name="VersionInfoView" Grid.Row="1" Visibility="Visible">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="20"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Tray Version -->
                        <Border Grid.Row="0" Background="#F8F8F8" BorderBrush="#DDDDDD"
                                BorderThickness="1" Padding="15" CornerRadius="5">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="8"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="8"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="110"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
                                           Text="Tray Application" FontSize="13" FontWeight="Bold"
                                           Foreground="#357ABD" Margin="0,0,0,8"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Version:"
                                           Style="{StaticResource InfoLabelStyle}"/>
                                <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal">
                                    <TextBlock x:Name="TrayVersionText" Style="{StaticResource InfoValueStyle}"/>
                                    <TextBlock x:Name="TrayLatestVersionText" Margin="8,0,0,0" Visibility="Collapsed"
                                               Text="(Latest Version)" Foreground="#5CB85C" FontWeight="Bold" FontSize="12"/>
                                    <TextBlock x:Name="TrayPreReleaseText" Margin="8,0,0,0" Visibility="Collapsed"
                                               Text="(Pre-release)" Foreground="#FF8C00" FontWeight="Bold" FontSize="12"/>
                                    <TextBlock x:Name="TrayUnableToConfirmText" Margin="8,0,0,0" Visibility="Collapsed"
                                               Text="(unable to confirm)" Foreground="#999999" FontStyle="Italic" FontSize="12"/>
                                    <TextBlock x:Name="TrayUpdateLinkText" Margin="8,0,0,0" Visibility="Collapsed">
                                        <Hyperlink x:Name="TrayUpdateLink" NavigateUri="https://github.com/toohighonthehog/RJAutoMover/blob/main/installer/RJAutoMoverSetup.exe" RequestNavigate="UpdateLink_RequestNavigate">
                                            <Run Foreground="#4A90E2" FontWeight="Bold" Text="(new version available: "/><Run x:Name="TrayNewVersionRun" Foreground="#4A90E2" FontWeight="Bold"/><Run Foreground="#4A90E2" FontWeight="Bold" Text=")"/>
                                        </Hyperlink>
                                    </TextBlock>
                                </StackPanel>

                                <TextBlock Grid.Row="4" Grid.Column="0" Text="Build Date:"
                                           Style="{StaticResource InfoLabelStyle}"/>
                                <TextBlock x:Name="TrayBuildDateText" Grid.Row="4" Grid.Column="1"
                                           Style="{StaticResource InfoValueStyle}"/>
                            </Grid>
                        </Border>

                        <!-- Service Version (Clickable to refresh) -->
                        <Button Grid.Row="2" Background="#F8F8F8" BorderBrush="#DDDDDD"
                                BorderThickness="1" Padding="15" HorizontalContentAlignment="Stretch"
                                Cursor="Hand" Click="RefreshVersionInfo_Click"
                                ToolTip="Click to refresh version information">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        CornerRadius="5"
                                                        Padding="{TemplateBinding Padding}">
                                                    <ContentPresenter/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#E8F4F8"/>
                                            <Setter Property="BorderBrush" Value="#4A90E2"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="8"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="8"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="8"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="110"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
                                           Text="Background Service" FontSize="13" FontWeight="Bold"
                                           Foreground="#357ABD" Margin="0,0,0,8"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Version:"
                                           Style="{StaticResource InfoLabelStyle}"/>
                                <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal">
                                    <TextBlock x:Name="ServiceVersionText" Style="{StaticResource InfoValueStyle}"/>
                                    <TextBlock x:Name="ServiceLatestVersionText" Margin="8,0,0,0" Visibility="Collapsed"
                                               Text="(Latest Version)" Foreground="#5CB85C" FontWeight="Bold" FontSize="12"/>
                                    <TextBlock x:Name="ServicePreReleaseText" Margin="8,0,0,0" Visibility="Collapsed"
                                               Text="(Pre-release)" Foreground="#FF8C00" FontWeight="Bold" FontSize="12"/>
                                    <TextBlock x:Name="ServiceUnableToConfirmText" Margin="8,0,0,0" Visibility="Collapsed"
                                               Text="(unable to confirm)" Foreground="#999999" FontStyle="Italic" FontSize="12"/>
                                    <TextBlock x:Name="ServiceUpdateLinkText" Margin="8,0,0,0" Visibility="Collapsed">
                                        <Hyperlink x:Name="ServiceUpdateLink" NavigateUri="https://github.com/toohighonthehog/RJAutoMover/blob/main/installer/RJAutoMoverSetup.exe" RequestNavigate="UpdateLink_RequestNavigate">
                                            <Run Foreground="#4A90E2" FontWeight="Bold" Text="(new version available: "/><Run x:Name="ServiceNewVersionRun" Foreground="#4A90E2" FontWeight="Bold"/><Run Foreground="#4A90E2" FontWeight="Bold" Text=")"/>
                                        </Hyperlink>
                                    </TextBlock>
                                </StackPanel>

                                <TextBlock Grid.Row="4" Grid.Column="0" Text="Build Date:"
                                           Style="{StaticResource InfoLabelStyle}"/>
                                <TextBlock x:Name="ServiceBuildDateText" Grid.Row="4" Grid.Column="1"
                                           Style="{StaticResource InfoValueStyle}"/>

                                <TextBlock Grid.Row="6" Grid.Column="0" Text="Run As:"
                                           Style="{StaticResource InfoLabelStyle}"/>
                                <TextBlock x:Name="ServiceAccountText" Grid.Row="6" Grid.Column="1"
                                           Style="{StaticResource InfoValueStyle}"/>
                            </Grid>
                        </Button>
                        </Grid>

                        <!-- .NET Build Info View -->
                        <Grid x:Name="DotNetInfoView" Grid.Row="1" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="10"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Build Information Section -->
                            <Border Grid.Row="0" Background="#F8F8F8" BorderBrush="#DDDDDD"
                                    BorderThickness="1" Padding="12" CornerRadius="5">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="8"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="160"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Build SDK Version:"
                                               Style="{StaticResource InfoLabelStyle}"/>
                                    <TextBlock x:Name="SdkVersionText" Grid.Row="0" Grid.Column="1"
                                               Style="{StaticResource InfoValueStyle}"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Current Runtime:"
                                               Style="{StaticResource InfoLabelStyle}"/>
                                    <TextBlock x:Name="CurrentRuntimeVersionText" Grid.Row="2" Grid.Column="1"
                                               Style="{StaticResource InfoValueStyle}"/>
                                </Grid>
                            </Border>

                            <!-- NuGet Packages Section -->
                            <Border Grid.Row="2" Background="#F8F8F8" BorderBrush="#DDDDDD"
                                    BorderThickness="1" Padding="12" CornerRadius="5">
                                <TextBlock x:Name="PackageVersionsText"
                                           FontFamily="Consolas, Courier New" FontSize="10"
                                           Foreground="#333333" TextWrapping="Wrap"
                                           Text="Loading package information..."/>
                            </Border>
                        </Grid>
                    </Grid>
                </Border>
            </TabItem>

            <!-- Error Tab (shown only when in error state) -->
            <TabItem x:Name="ErrorTab" Header="⚠ Error" Visibility="Collapsed">
                <Border Background="White" BorderBrush="#DDDDDD" BorderThickness="1,0,1,1" Padding="20">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <!-- Error Header -->
                            <Border Background="#FFF3CD" BorderBrush="#FFCD00" BorderThickness="1"
                                    Padding="15" CornerRadius="5" Margin="0,0,0,15">
                                <StackPanel>
                                    <TextBlock Text="⚠ Service Error Detected" FontSize="14" FontWeight="Bold"
                                               Foreground="#856404" Margin="0,0,0,8"/>
                                    <TextBlock Text="The RJAutoMover service is in an error state and may not be processing files correctly."
                                               FontSize="12" Foreground="#856404" TextWrapping="Wrap"/>
                                </StackPanel>
                            </Border>

                            <!-- Error Details -->
                            <TextBlock Text="Error Details:" FontSize="13" FontWeight="Bold"
                                       Foreground="#357ABD" Margin="0,0,0,10"/>

                            <Border Background="#F8F8F8" BorderBrush="#DDDDDD" BorderThickness="1"
                                    Padding="15" CornerRadius="5">
                                <TextBlock x:Name="ErrorMessageText"
                                           FontFamily="Consolas, Courier New" FontSize="11"
                                           Foreground="#333333" TextWrapping="Wrap"
                                           Text="Loading error information..."/>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </TabItem>
        </TabControl>

        <!-- Footer with Buttons -->
        <Border Grid.Row="2" Background="White" BorderBrush="#DDDDDD"
                BorderThickness="0,1,0,0" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="10"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" VerticalAlignment="Center"
                           Foreground="#888888" FontSize="10">
                    © 2025 RJAutoMover. All rights reserved.
                </TextBlock>

                <Button x:Name="ExitButton" Grid.Column="1" Content="Exit Application"
                        Padding="15,5" MinWidth="80" Click="ExitButton_Click"
                        Background="#D9534F" Foreground="White"
                        BorderThickness="0" FontWeight="Bold" Cursor="Hand">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Background" Value="#D9534F"/>
                            <Setter Property="Foreground" Value="White"/>
                            <Setter Property="BorderThickness" Value="0"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                                CornerRadius="3" Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center"
                                                            VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#C9302C"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>

                <Button x:Name="CloseButton" Grid.Column="3" Content="Close"
                        Padding="20,5" MinWidth="80" Click="CloseButton_Click"
                        Background="#4A90E2" Foreground="White"
                        BorderThickness="0" FontWeight="Bold" Cursor="Hand">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Background" Value="#4A90E2"/>
                            <Setter Property="Foreground" Value="White"/>
                            <Setter Property="BorderThickness" Value="0"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                                CornerRadius="3" Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center"
                                                            VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#357ABD"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </Grid>
        </Border>
    </Grid>
</Window>
